# 仓库看板模块

### 1、仓库任务监控

#### 1.1计划入库量

```sql
sql语句
SELECT CAST(SUM(F_PlanQty) AS DECIMAL(18,0)) AS InPlanQty FROM wms_warehousein_detail 

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": 1472140708
}
```



#### 1.2 实际入库量

```sql
sql语句
SELECT CAST(SUM(F_RealQty) AS DECIMAL(18,0)) AS InRealQty FROM wms_warehousein_detail 

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": 77955598
}
```



#### 1.3 计划出库量

```sql
sql语句
SELECT CAST(SUM(F_PlanQty) AS DECIMAL(18,0)) AS OutPlanQty FROM wms_warehouseout_detail 

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": 1298840672
}
```



#### 1.4 实际出库量

```sql
sql语句

SELECT CAST(SUM(F_RealQty) AS DECIMAL(18,0)) AS OutRealQty FROM wms_warehouseout_detail

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": 1680
}
```



### 2、仓库库存监控

#### 2.1 库存总量

```sql
sql语句
SELECT CAST(SUM(F_AvailableQty) AS DECIMAL(18,0)) AS TotalQty FROM wms_inventory

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": 60516513
}
```



#### 2.2 出存总量

```sql
sql语句
SELECT CAST(SUM(F_RealQty) AS DECIMAL(18,0)) AS InRealQty FROM wms_warehousein_detail

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": 77955598
}
```



#### 2.3 出存总量

```sql
sql语句
SELECT CAST(SUM(F_RealQty) AS DECIMAL(18,0)) AS OutRealQty FROM wms_warehouseout_detail

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": 1680
}

```



### 3、近日出入库对比

```sql
sql语句

CREATE TABLE #InOutWarehouseInfo
(
	OpDate			NVARCHAR(20),
	TotalInQty		DECIMAL(18,0),
	TotalOutQty		DECIMAL(18,0)
)
DECLARE @StartIdx	INT = 0
DECLARE @EndIdx		INT = 6
DECLARE @CurDate	DATETIME = GETDATE() --'2024-12-05'
WHILE @StartIdx<=@EndIdx
BEGIN
	DECLARE @SearchDate		DATETIME
	DECLARE @StrSearchDate	NVARCHAR(10)
	SET @SearchDate=DATEADD(DAY, -@StartIdx, @CurDate)
	SET @StrSearchDate=RIGHT(CONVERT(NVARCHAR(50),@SearchDate,111),5)
	DECLARE @DayTotalIn		DECIMAL(18,0)
	DECLARE @DayTotalOut	DECIMAL(18,0)
	SELECT @DayTotalIn=ISNULL(SUM(F_Qty),0) FROM wms_warehousein_scandetail WHERE DATEDIFF(DAY, F_CreatorTime, @SearchDate)=0
	SELECT @DayTotalOut=ISNULL(SUM(F_Qty),0) FROM wms_warehouseout_scandetail WHERE DATEDIFF(DAY, F_CreatorTime, @SearchDate)=0
	INSERT INTO #InOutWarehouseInfo VALUES (@StrSearchDate,@DayTotalIn,@DayTotalOut)
	SET @StartIdx=@StartIdx+1
END

SELECT * FROM #InOutWarehouseInfo
DROP TABLE #InOutWarehouseInfo

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "OpDate": "12/11",
        "TotalInQty": 0,
        "TotalOutQty": 0
    },
    {
        "OpDate": "12/10",
        "TotalInQty": 337500,
        "TotalOutQty": 0
    },
    {
        "OpDate": "12/09",
        "TotalInQty": 209609,
        "TotalOutQty": 0
    }
]
```



### 4、物料库存监控

```sql
SELECT TOP 6 b.F_PartNo AS PartNo,b.F_PartName AS PartName,c.F_Name AS WarehouseName, a.F_AvailableQty AS CurQty
FROM wms_inventory a INNER JOIN base_part b ON a.F_PartId=b.F_Id LEFT JOIN base_warehouse c ON a.F_WarehouseId=c.F_Id
ORDER BY NEWID()
```



### 5、入库分析

```sql
sql语句

CREATE TABLE #InWarehouseInfo
(
	OpDate			NVARCHAR(20),
	FinishInQty		DECIMAL(18,0),
	RawInQty		DECIMAL(18,0)
)
DECLARE @StartIdx	INT = 0
DECLARE @EndIdx		INT = 6
DECLARE @CurDate	DATETIME = GETDATE()
WHILE @StartIdx<=@EndIdx
BEGIN
	DECLARE @SearchDate		DATETIME
	DECLARE @StrSearchDate	NVARCHAR(10)
	SET @SearchDate=DATEADD(DAY, -@StartIdx, @CurDate)
	SET @StrSearchDate=RIGHT(CONVERT(NVARCHAR(50),@SearchDate,111),5)
	DECLARE @DayFinishIn	DECIMAL(18,0)
	DECLARE @RawInIn		DECIMAL(18,0)
	SELECT @DayFinishIn=ISNULL(SUM(F_Qty),0) FROM wms_warehousein_scandetail WHERE DATEDIFF(DAY, F_CreatorTime, @SearchDate)=0 AND F_WarehouseId='992'
	SELECT @RawInIn=ISNULL(SUM(F_Qty),0) FROM wms_warehousein_scandetail WHERE DATEDIFF(DAY, F_CreatorTime, @SearchDate)=0 AND F_WarehouseId='17257'
	INSERT INTO #InWarehouseInfo VALUES (@StrSearchDate,@DayFinishIn,@RawInIn)
	SET @StartIdx=@StartIdx+1
END

SELECT * FROM #InWarehouseInfo
DROP TABLE #InWarehouseInfo

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "OpDate": "12/11",
        "FinishInQty": 0,
        "RawInQty": 0
    },
    {
        "OpDate": "12/10",
        "FinishInQty": 335741,
        "RawInQty": 1759
    },
    {
        "OpDate": "12/09",
        "FinishInQty": 188721,
        "RawInQty": 0
    }
]
```



### 6、出库分析

```sql
sql语句

CREATE TABLE #OutWarehouseInfo
(
	OpDate			NVARCHAR(20),
	FinishOutQty	DECIMAL(18,0),
	RawOutQty		DECIMAL(18,0)
)
DECLARE @StartIdx	INT = 0
DECLARE @EndIdx		INT = 6
DECLARE @CurDate	DATETIME = GETDATE()
WHILE @StartIdx<=@EndIdx
BEGIN
	DECLARE @SearchDate		DATETIME
	DECLARE @StrSearchDate	NVARCHAR(10)
	SET @SearchDate=DATEADD(DAY, -@StartIdx, @CurDate)
	SET @StrSearchDate=RIGHT(CONVERT(NVARCHAR(50),@SearchDate,111),5)
	DECLARE @DayFinishOut	DECIMAL(18,0)
	DECLARE @DayRawIn		DECIMAL(18,0)
	SELECT @DayFinishOut=ISNULL(SUM(F_Qty),0) FROM wms_warehouseout_scandetail WHERE DATEDIFF(DAY, F_CreatorTime, @SearchDate)=0 AND F_WarehouseId='992'
	SELECT @DayRawIn=ISNULL(SUM(F_Qty),0) FROM wms_warehouseout_scandetail WHERE DATEDIFF(DAY, F_CreatorTime, @SearchDate)=0 AND F_WarehouseId='17257'
	INSERT INTO #OutWarehouseInfo VALUES (@StrSearchDate,@DayFinishOut,@DayRawIn)
	SET @StartIdx=@StartIdx+1
END

SELECT * FROM #OutWarehouseInfo
DROP TABLE #OutWarehouseInfo

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "OpDate": "12/11",
        "FinishOutQty": 0,
        "RawOutQty": 0
    },
    {
        "OpDate": "12/10",
        "FinishOutQty": 0,
        "RawOutQty": 0
    },
    {
        "OpDate": "12/09",
        "FinishOutQty": 0,
        "RawOutQty": 0
    }
]

```



### 7、上架任务分析

```sql
sql语句

SELECT * FROM #InWarehouseInfo
DROP TABLE #InWarehouseInfo

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "OpDate": "12/11",
        "FinishInQty": 2,
        "RawInQty": 8
    },
    {
        "OpDate": "12/10",
        "FinishInQty": 5,
        "RawInQty": 54
    },
    {
        "OpDate": "12/09",
        "FinishInQty": 41,
        "RawInQty": 7
    }
]
```



### 8、今日出入库单据状态占比

```sql
sql语句

SELECT count(*) as value,'待出库' name from wms_warehouseout where   DATEDIFF(day, F_WarehouseDate, GETDATE()) =0 and F_Status=1
	union all
SELECT count(*) as value,'待入库' name  from wms_warehousein where   DATEDIFF(day, F_WarehouseDate, GETDATE()) =0 and F_Status=1
union all
SELECT count(*) as value,'已出库' name  from wms_warehouseout where   DATEDIFF(day, F_WarehouseDate, GETDATE()) =0 and F_Status=4
	union all
SELECT count(*) as value,'已入库' name  from wms_warehousein where   DATEDIFF(day, F_WarehouseDate, GETDATE()) =0 and F_Status=4

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "value": 10,
        "name": "待出库"
    },
    {
        "value": 14,
        "name": "待入库"
    },
    {
        "value": 0,
        "name": "已出库"
    },
    {
        "value": 0,
        "name": "已入库"
    }
]
```



### 9、成品库实时监控

```sql
sql语句

SELECT TOP 1 b.F_PartNo AS PartNo,a.F_AvailableQty AS CurQty,c.F_Name AS LocationName
FROM wms_inventory a LEFT JOIN base_part b ON a.F_PartId=b.F_Id
LEFT JOIN base_location c ON a.F_LocationId=c.F_Id
 WHERE a.F_WarehouseId='992' ORDER BY NEWID()
 
  响应数据格式(只展示至多三条数据，多的不显示)
 [
    {
        "PartNo": "30.46.H1.YPD07-25L070-101",
        "CurQty": 1939,
        "LocationName": "外协件仓库_待分类"
    }
]
```



### 10、包装车间实时监控

```sql
sql语句

SELECT TOP 1 a.F_PartNo AS PartNo,CAST(ISNULL(SUM(a.F_PlanQty),0) AS DECIMAL(18,0)) AS TotalQty,'默认货位' AS LocationName
FROM wms_warehousein_detail a LEFT JOIN wms_warehousein b ON a.F_WarehouseInId=b.F_Id
 WHERE b.F_WorkShopId='1083' GROUP BY a.F_PartNo ORDER BY NEWID()
 
 响应数据格式(只展示至多三条数据，多的不显示)
 
 [
    {
        "PartNo": "20.01.A.2001-01",
        "TotalQty": 221,
        "LocationName": "默认货位"
    }
]
```



### 11、杆盘车间实时监控

```sql
sql语句

SELECT TOP 1 a.F_PartNo AS PartNo,CAST(ISNULL(SUM(a.F_PlanQty),0) AS DECIMAL(18,0)) AS TotalQty,'默认货位' AS LocationName
FROM wms_warehousein_detail a LEFT JOIN wms_warehousein b ON a.F_WarehouseInId=b.F_Id
 WHERE b.F_WorkShopId='1082' GROUP BY a.F_PartNo ORDER BY NEWID()
 
  响应数据格式(只展示至多三条数据，多的不显示)
  
 [
    {
        "PartNo": "20.03.A.2404-05",
        "TotalQty": 77740,
        "LocationName": "默认货位"
    }
]
```



### 12、原料库实时监控

```sql
sql语句
SELECT TOP 1 b.F_PartNo AS PartNo,a.F_AvailableQty AS CurQty,c.F_Name AS LocationName
FROM wms_inventory a LEFT JOIN base_part b ON a.F_PartId=b.F_Id
LEFT JOIN base_location c ON a.F_LocationId=c.F_Id
 WHERE a.F_WarehouseId='992' ORDER BY NEWID()
 
 响应数据格式(只展示至多三条数据，多的不显示)
 
 [
    {
        "PartNo": "30.46.W1.M18-25G00603",
        "CurQty": 2680,
        "LocationName": "外协件仓库_待分类"
    }
]
```

