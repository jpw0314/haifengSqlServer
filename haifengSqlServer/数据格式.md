# 生产进度看板模块

### 1、生产统计分析图表

```sql
sql语句

SELECT CONVERT(DECIMAL(18,0), OkQty)	OkQty ,
       CONVERT(DECIMAL(18, 0), TotalQty)	TotalQty,
       CONVERT(DECIMAL(18, 2), OkQty*100/IIF(TotalQty=0, 1, TotalQty)) AS OkRate,
	   RIGHT(OpDate,5)	OpDate
FROM 
    (SELECT TOP 3 SUM(F_OkQty)	OkQty,
        SUM(F_OkQty+F_NgQty)	TotalQty,
        CONVERT(VARCHAR(100), F_CreatorTime, 111)   OpDate
    FROM mes_report_detail
    WHERE DATEDIFF(DAY,F_CreatorTime,GETDATE())<=14  AND DATEDIFF(day,F_CreatorTime,GETDATE())>= 0 AND (F_OkQty+F_NgQty)>0  
    GROUP BY  CONVERT(VARCHAR(100), F_CreatorTime, 111)  
    ORDER BY  OpDate DESC) a
ORDER BY OpDate

响应数据格式(只展示至多三条数据，多的不显示)

优化后的sql语句
SELECT CONVERT(DECIMAL(18,0), OkQty) AS OkQty,
       CONVERT(DECIMAL(18,0), TotalQty) AS TotalQty,
       CONVERT(DECIMAL(18,2), OkQty*100.0/NULLIF(TotalQty,0)) AS OkRate,
       RIGHT(OpDate,5) AS OpDate
FROM 
    (SELECT TOP 3 
        SUM(F_OkQty) AS OkQty,
        SUM(F_OkQty+F_NgQty) AS TotalQty,
        CONVERT(VARCHAR(100), F_CreatorTime, 111) AS OpDate
    FROM mes_report_detail
    WHERE F_CreatorTime >= DATEADD(DAY, -14, CAST(GETDATE() AS DATE))
      AND F_CreatorTime < DATEADD(DAY, 1, CAST(GETDATE() AS DATE))
      AND (F_OkQty+F_NgQty)>0  
    GROUP BY CONVERT(VARCHAR(100), F_CreatorTime, 111)  
    ORDER BY OpDate DESC) a
ORDER BY OpDate


[
    {
        "OkQty": 18000,
        "TotalQty": 18110,
        "OkRate": 99.39,
        "OpDate": "12/07"
    },
    {
        "OkQty": 36160,
        "TotalQty": 36470,
        "OkRate": 99.15,
        "OpDate": "12/08"
    },
    {
        "OkQty": 16500,
        "TotalQty": 16620,
        "OkRate": 99.28,
        "OpDate": "12/09"
    }
]

```

### 2、原料消耗统计图表

```sql
sql语句

SELECT Convert(decimal(18,0), oknumb)oknumb ,
       Convert(decimal(18, 0), total)total,
       Convert(decimal(18, 2), oknumb*100/total) AS ratess,right( dayss,5)dayss
FROM 
    (SELECT top 6 sum(F_OkQty) oknumb,
        sum(F_OkQty+F_NgQty)total,
        CONVERT(varchar(100), F_CreatorTime, 111)   dayss
    FROM mes_report_detail
    WHERE datediff(day,F_CreatorTime,getdate())<=14  and datediff(day,F_CreatorTime,getdate())>= 0 and (F_OkQty+F_NgQty)>0  
    GROUP BY  CONVERT(varchar(100), F_CreatorTime, 111)  
    ORDER BY  dayss desc) a
ORDER BY  dayss

优化后的sql语句
SELECT CONVERT(DECIMAL(18,0), oknumb) AS oknumb,
       CONVERT(DECIMAL(18,0), total) AS total,
       CONVERT(DECIMAL(18,2), oknumb*100.0/NULLIF(total,0)) AS ratess,
       RIGHT(dayss,5) AS dayss
FROM 
    (SELECT TOP 6 
        SUM(F_OkQty) AS oknumb,
        SUM(F_OkQty+F_NgQty) AS total,
        CONVERT(VARCHAR(100), F_CreatorTime, 111) AS dayss
    FROM mes_report_detail
    WHERE F_CreatorTime >= DATEADD(DAY, -14, CAST(GETDATE() AS DATE))
      AND F_CreatorTime < DATEADD(DAY, 1, CAST(GETDATE() AS DATE))
      AND (F_OkQty+F_NgQty)>0  
    GROUP BY CONVERT(VARCHAR(100), F_CreatorTime, 111)  
    ORDER BY dayss DESC) a
ORDER BY dayss

响应数据格式(只展示至多三条数据，多的不显示)

[
    {
        "oknumb": 24400,
        "total": 24760,
        "ratess": 98.55,
        "dayss": "12/02"
    },
    {
        "oknumb": 22670,
        "total": 22930,
        "ratess": 98.87,
        "dayss": "12/03"
    },
    {
        "oknumb": 47800,
        "total": 48180,
        "ratess": 99.21,
        "dayss": "12/04"
    }
]
```

### 3、本月计划

#### 3.1月合格率

```sql
sql语句

select convert(decimal(18,0),round(sum(F_OkQty)*100.00/IIF(sum(F_OkQty+F_NgQty)=0,1,sum(F_OkQty+F_NgQty)),0) ) value
 from mes_report_detail
where datediff(mm,F_CreatorTime,GETDATE())=0

优化后的sql语句
SELECT CONVERT(DECIMAL(18,0), ROUND(SUM(F_OkQty)*100.0/NULLIF(SUM(F_OkQty+F_NgQty),0),0)) AS value
FROM mes_report_detail
WHERE F_CreatorTime >= DATEADD(MONTH, DATEDIFF(MONTH, 0, GETDATE()), 0)
  AND F_CreatorTime < DATEADD(MONTH, DATEDIFF(MONTH, 0, GETDATE()) + 1, 0)

响应数据格式(只展示至多三条数据，多的不显示)
{
    "data": 99
}
```

#### 3.2日合格率

```sql
sql语句

select convert(decimal(18,0),round(ISNULL(sum(F_OkQty),0)*100.00/IIF(ISNULL(sum(F_OkQty+F_NgQty),0)=0,1,sum(F_OkQty+F_NgQty)),2) ) value
from mes_report_detail
where datediff(dd,F_CreatorTime,GETDATE())=0

优化后的sql语句
SELECT CONVERT(DECIMAL(18,0), ROUND(ISNULL(SUM(F_OkQty),0)*100.0/NULLIF(ISNULL(SUM(F_OkQty+F_NgQty),0),0),2)) AS value
FROM mes_report_detail
WHERE F_CreatorTime >= CAST(GETDATE() AS DATE)
  AND F_CreatorTime < DATEADD(DAY, 1, CAST(GETDATE() AS DATE))

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "value": 99
    }
]
```

#### 3.3 未完成值

```sql
sql语句
select convert(decimal(18,0),round(ISNULL(sum(F_RequireAmount-F_OkQty-F_NgQty),0),2) ) curValue
from base_workorder
where datediff(dd,F_CreatorTime,GETDATE())=0

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": 300818
}
```

#### 3.4完成率

```sql
sql语句
select convert(decimal(18,0),round(ISNULL(sum(F_OkQty+F_NgQty),0)*100.00/IIF(ISNULL(sum(F_RequireAmount),0)=0,1,sum(F_RequireAmount)),2) ) curValue
from base_workorder
where datediff(dd,F_CreatorTime,GETDATE())=0

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": "2%"
}
```

#### 3.5 完成/计划显示值

```sql
sql语句
select convert(nvarchar(10),convert(decimal(18,0),ISNULL(sum(F_OkQty+F_NgQty),0)))+'/'+convert(nvarchar(20),convert(decimal(18,0),ISNULL(sum(F_RequireAmount),0))) curValue
from base_workorder
where datediff(dd,F_CreatorTime,GETDATE())=0

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": "6685/307503"
}
```



### 4、生产入库信息统计

```sql
sql语句

SELECT TOP 5 a.F_PartName 产品型号,
SUM(F_Qty) 当月入库数,
(SELECT SUM(F_AvailableQty) FROM wms_inventory WHERE F_PartId=a.F_PartId) 库存数
from wms_warehousein_scandetail a
LEFT JOIN wms_warehousein b on a.F_WarehouseId=b.F_Id
WHERE F_WarehouseType='ProduceIn'
AND datediff(month, a.F_CreatorTime,GETDATE())=0
GROUP BY a.F_PartName,a.F_PartId

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "产品型号": "粘毛器短款外箱大隔板480*200(驱尘氏)1用3",
        "当月入库数": 5207,
        "库存数": 940
    },
    {
        "产品型号": "粘毛器短款外箱大隔板480*200(驱尘氏8套装)1用3(客HF043-1)",
        "当月入库数": 939,
        "库存数": 940
    },
    {
        "产品型号": "(现场)组件-马桶刷桶身白7044+盖子灰7040+边扣白7044",
        "当月入库数": 3608,
        "库存数": null
    },
    {
        "产品型号": "(现场)组件(美)-马桶刷桶身白7044+盖子灰7040+边扣白7044",
        "当月入库数": 600,
        "库存数": null
    },
    {
        "产品型号": "组件-马桶刷上手柄白7044+盖子灰7040",
        "当月入库数": 62778,
        "库存数": 4804
    }
]
}
```

### 5、实时产能监控

```sql
sql语句

select aa.F_FullName value,ISNULL(bb.数量,0) name from base_organize aa
left join (
select b.F_WorkShopId,sum(a.F_OkQty+a.F_NgQty) 数量 from mes_report_detail a
left join base_workorder b on F_WoId=b.F_Id 
where datediff(mm,a.F_creatortime,getdate())=0
group by b.F_WorkShopId)bb on aa.F_Id =bb.F_WorkShopId
where aa.F_Id in (
'1081',
'1082',
'1083'
)

优化后的sql语句
SELECT aa.F_FullName AS value, ISNULL(bb.数量,0) AS name 
FROM base_organize aa
LEFT JOIN (
    SELECT b.F_WorkShopId, SUM(a.F_OkQty+a.F_NgQty) AS 数量 
    FROM mes_report_detail a
    LEFT JOIN base_workorder b ON a.F_WoId=b.F_Id 
    WHERE a.F_CreatorTime >= DATEADD(MONTH, DATEDIFF(MONTH, 0, GETDATE()), 0)
      AND a.F_CreatorTime < DATEADD(MONTH, DATEDIFF(MONTH, 0, GETDATE()) + 1, 0)
    GROUP BY b.F_WorkShopId
) bb ON aa.F_Id = bb.F_WorkShopId
WHERE aa.F_Id IN ('1081', '1082', '1083')

响应数据格式(只展示至多三条数据，多的不显示)
{
    "xList": [
        0,
        0,
        180230
    ],
    "yList": [
        "包装车间",
        "杆盘车间",
        "注塑车间"
    ]
}
```

### 6、生产进度信息

```sql
sql语句
select  top 30 
a.F_WoNo 工单号
,a.F_PartNo 物料编号
,a.F_PartName 物料名称
,c.F_Specs 规格型号
,a.F_OkQty 合格数
,a.F_NgQty 不良数
,a.F_RequireAmount 需求数
,b.F_UnitName 单位
,convert(nvarchar,convert(decimal(18,2),round((F_OkQty+F_NgQty)*100/IIF(ISNULL(F_RequireAmount,0)=0,1,ISNULL(F_RequireAmount,0)),2)))+'%' 生产进度
,case when a.F_Status=0 then '创建' 
when  a.F_Status=1 then '已排程' 
when  a.F_Status=2 then '已下发' 
when  a.F_Status=3 then '生产中' 
when  a.F_Status=4 then '已完成' 
when  a.F_Status=5 then '强制结单' 
else '已取消' end 生产状态
from base_workorder a
left join base_unit b on a.F_Unit=b.F_Id
left join base_part c on a.F_partid=c.F_id
where a.F_CreatorTime>DATEDIFF(day,GETDATE(),-30)
order by F_RequireTime desc

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "工单号": "WO20250728028",
        "物料编号": "02.05.C.1903-01",
        "物料名称": "螺母22#细-黑色3#",
        "规格型号": "20*28",
        "合格数": 0,
        "不良数": 0,
        "需求数": 4840,
        "单位": "个",
        "生产进度": "0.00%",
        "生产状态": "已排程"
    },
    {
        "工单号": "WO20251127015",
        "物料编号": "02.04.B.D10.1511-02",
        "物料名称": "组件-马桶刷上手柄白7044+盖子灰7040",
        "规格型号": "2.3*2.3*20.5+2.5*2.5",
        "合格数": 12500,
        "不良数": 150,
        "需求数": 12000,
        "单位": "个",
        "生产进度": "105.42%",
        "生产状态": "已完成"
    },
    {
        "工单号": "WO20251127010",
        "物料编号": "02.03.B.PM33.1135-03",
        "物料名称": "小号四面挤水-装饰件-蓝色1172(色粉)",
        "规格型号": "98*14*6",
        "合格数": 0,
        "不良数": 0,
        "需求数": 19300,
        "单位": "个",
        "生产进度": "0.00%",
        "生产状态": "已下发"
    }
]
```

### 7、点检未完成项

```sql
sql语句

select F_EquipName 
,count(1) b from
eq_check_record where F_Status=0
group by F_EquipName

响应数据格式(只展示至多三条数据，多的不显示)

[
    {
        "F_EquipName": "21号注塑机(570)",
        "b": 175
    },
    {
        "F_EquipName": "26号注塑机(370)",
        "b": 175
    },
    {
        "F_EquipName": "14号注塑机(540)",
        "b": 170
    },
    {
        "F_EquipName": "34号注塑机(2250)",
        "b": 175
    }
]
```

### 9、各部门当日计划数

```sql
sql语句
select name dayss1,value onoffrate  from (
select top 7 right(convert(nvarchar(10), F_CreatorTime,120),5) name,
sum(case when F_Status=1 then 1 else 0 end)*100.0 /ISNULL(count(1),1) value from eq_check_record
--where datediff(dd,F_CreatorTime,getdate())<7
group by convert(nvarchar(10), F_CreatorTime,120)
order by  convert(nvarchar(10), F_CreatorTime,120) desc
)aa
order by aa.name

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "dayss1": "12-06",
        "onoffrate": 0
    },
    {
        "dayss1": "12-07",
        "onoffrate": 0
    },
    {
        "dayss1": "12-08",
        "onoffrate": 0
    },
    {
        "dayss1": "12-09",
        "onoffrate": 0
    },
]
```



#### 9.1计划入库量

```sql
sql语句
select  avg( F_Efficienc) value
from base_equip_runinfo
 where  datediff(day,F_CreateTime,getdate())=0
 
 响应数据格式(只展示至多三条数据，多的不显示)
 {
    "data": "69.50"
}
```



#### 9.2点检完成率

```sql
sql语句
select sum(case when F_Status=1 then 1 else 0 end)*100.0 /ISNULL(count(1),1) value from eq_check_record
where datediff(mm,F_CreatorTime,getdate())=0

响应数据格式(只展示至多三条数据，多的不显示)
{
    "data": "0.00"
}
```



#### 9.3维修完成率

```sql
sql语句

select ISNULL(sum(case when F_Status=1 then 1 else 0 end)*100.0 /ISNULL(count(1),1),0) value from eq_repair_record
where datediff(mm,F_CreatorTime,getdate())=0

响应数据格式(只展示至多三条数据，多的不显示)
{
    "data": "0.00"
}
```



# 综合看板模块

### 1、订单情况

```sql
sql语句

SELECT Convert(decimal(18,0), oknumb)oknumb ,
       Convert(decimal(18, 0), total)total,
       Convert(decimal(18, 2), oknumb*100/total) AS ratess,right( dayss,5)dayss
FROM 
    (SELECT top 6 sum(F_OkQty) oknumb,
        sum(F_OkQty+F_NgQty)total,
        CONVERT(varchar(100), F_CreatorTime, 111)   dayss
    FROM mes_report_detail
    WHERE datediff(day,F_CreatorTime,getdate())<=14  and datediff(day,F_CreatorTime,getdate())>= 0 and (F_OkQty+F_NgQty)>0  
    GROUP BY  CONVERT(varchar(100), F_CreatorTime, 111)  
    ORDER BY  dayss desc) a
ORDER BY  dayss

响应数据格式(只展示至多三条数据，多的不显示)

[
    {
        "oknumb": 24400,
        "total": 24760,
        "ratess": 98.55,
        "dayss": "12/02"
    },
    {
        "oknumb": 22670,
        "total": 22930,
        "ratess": 98.87,
        "dayss": "12/03"
    }
]
```

### 2、设备情况

```sql
sql语句

select onoffrate,oee,right(dayss,5)dayss1 from (
select top 6 F_EqOnOffRate onoffrate, F_Efficienc oee,  CONVERT(NVARCHAR(50),F_EqRunDate,111)  dayss  
from base_equip_runinfo
 where  datediff(day,F_EqRunDate,getdate())<=30  and  datediff(day,F_EqRunDate,getdate())>0
order by dayss desc
)aa 
order by dayss

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "onoffrate": 86.9,
        "oee": 80.4,
        "dayss1": "12/03"
    },
    {
        "onoffrate": 87.4,
        "oee": 80.8,
        "dayss1": "12/04"
    }
]

```

### 3、注塑日产量

```sql
sql语句

	select  right(dayss,5) dayss,numb from (
	select top 6 convert(nvarchar(10), F_RecordDate,120) dayss,sum(F_HadDone) numb  from eq_yield_day
	WHERE datediff(day,F_RecordDate,getdate())<=14  and datediff(day,F_RecordDate,getdate())>= 0 and F_HadDone>0 
	and F_EquipName like '%注塑%'
	group by convert(nvarchar(10), F_RecordDate,120)
	order by convert(nvarchar(10), F_RecordDate,120) desc
	)aa
	order by dayss
	
响应数据格式(只展示至多三条数据，多的不显示)

[
    {
        "dayss": "12-04",
        "numb": 54332
    },
    {
        "dayss": "12-05",
        "numb": 41236
    }
]
```

### 4、当月注塑机产量

```sql
sql语句

select * from (
select top 5 right(F_EquipCode,2)+'#'equip,sum(F_HadDone) haddone from eq_yield_day
where F_EquipName like '%注塑%' and convert(nvarchar(7),F_RecordDate,120) =convert(nvarchar(7),GETDATE(),120) 
group by F_EquipCode,	F_EquipId
order by sum(F_HadDone) desc
)a 
order by equip

响应数据格式(只展示至多三条数据，多的不显示)

[
    {
        "equip": "19#",
        "haddone": 26633
    },
    {
        "equip": "23#",
        "haddone": 17942
    }
]
```

### 5、设备故障明细

```sql
sql语句

SELECT TOP 3 F_TagDesc AS ErrorMsg,F_UploadTime AS UpTime FROM eq_tagsetting WHERE F_TagDesc LIKE '系统%' AND F_Result='1' ORDER BY F_UploadTime DESC

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "ErrorMsg": "系统一17号站缺料",
        "UpTime": "2025-01-15 09:04:25"
    },
    {
        "ErrorMsg": "系统二12号站缺料",
        "UpTime": "2025-01-14 10:56:00"
    }
]
```

### 6、产品入库分析

```sql
sql语句

SELECT OpDate name,FinishInQty value FROM #InWarehouseInfo order by OpDate
DROP TABLE #InWarehouseInfo

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "name": "12/03",
        "value": 218800
    },
    {
        "name": "12/04",
        "value": 186400
    }
]


```

### 7、设备运行情况

```sql
sql语句

DECLARE @RunNum			INT
DECLARE @OpenNum		INT
DECLARE @WarnNum		INT
DECLARE @CloseNum		INT
DECLARE @TotalNum		INT
SELECT @RunNum=COUNT(F_Id) from base_equip where F_Status='1'  AND F_WorkshopId='1081' AND F_IsVirtual!=2 --运行
SELECT @OpenNum=COUNT(F_Id) from base_equip where F_Status='0'  AND F_WorkshopId='1081' AND F_IsVirtual!=2 --待机
SELECT @WarnNum=COUNT(F_Id) from base_equip where F_Status='-1'  AND F_WorkshopId='1081' AND F_IsVirtual!=2 --报警
SELECT @CloseNum=COUNT(F_Id) from base_equip where F_Status='9'  AND F_WorkshopId='1081' AND F_IsVirtual!=2 --关机
SELECT @TotalNum=COUNT(F_Id) from base_equip where  F_WorkshopId='1081' AND F_IsVirtual!=2 --总数
SELECT @RunNum AS RunNum,@OpenNum AS OpenNum,@WarnNum AS WarnNum,@CloseNum AS CloseNum,@TotalNum AS TotalNum

优化的sql语句
-- 稍微简单一点的写法
SELECT 
    SUM(CASE F_Status WHEN '1' THEN 1 ELSE 0 END) AS RunNum,
    SUM(CASE F_Status WHEN '0' THEN 1 ELSE 0 END) AS OpenNum,
    SUM(CASE F_Status WHEN '-1' THEN 1 ELSE 0 END) AS WarnNum,
    SUM(CASE F_Status WHEN '9' THEN 1 ELSE 0 END) AS CloseNum,
    COUNT(*) AS TotalNum
FROM base_equip 
WHERE F_WorkshopId='1081' AND F_IsVirtual!=2


响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "RunNum": 37,
        "OpenNum": 7,
        "WarnNum": 0,
        "CloseNum": 5,
        "TotalNum": 52
    }
]
```

### 8、设备信息表

```sql
sql语句

SELECT *,
	(SELECT F_EquipCode FROM base_equip WHERE F_Id=F_EquipId) AS EquipCode
FROM
(SELECT 
REPLACE(F_TagId, F_EquipId + '/','') AS ParamName,
F_Result AS CurValue,
F_EquipId
FROM eq_tagsetting
WHERE F_EquipId=(SELECT TOP 1 F_Id FROM base_equip WHERE
F_EquipCode LIKE 'A.01%' AND F_WorkshopId='1081' AND F_IsVirtual!=2 ORDER BY NEWID()))
AS SourceTable
PIVOT
(
	MAX(CurValue)
	FOR ParamName IN (Currentyield,lastCyclePeriod,recentUseRate)
) AS PivotTable

响应数据格式(只展示至多三条数据，多的不显示)


[
    {
        "F_EquipId": "18272000",
        "Currentyield": "1016676",
        "lastCyclePeriod": "46.0",
        "recentUseRate": "100",
        "EquipCode": "A.01.200G.24"
    }
]
```

### 9、计划生产工单

```sql
sql语句

SELECT TOP 3 ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS RowNum, F_WoNo AS WoNo,'生产中' AS StrStatus FROM base_workorder WHERE F_Status=3 ORDER BY F_IssueTime DESC

响应数据格式(只展示至多三条数据，多的不显示)

[
    {
        "RowNum": 1,
        "WoNo": "WO20241129004",
        "StrStatus": "生产中"
    },
    {
        "RowNum": 2,
        "WoNo": "WO20241128003",
        "StrStatus": "生产中"
    },
    {
        "RowNum": 3,
        "WoNo": "WO20241126003",
        "StrStatus": "生产中"
    }
]
```

### 10、热销机型排行

```sql
sql语句

SELECT TOP 4 a.F_PartNo AS PartNo,SUM(a.F_PlanQty) AS TotalQty FROM wms_warehouseout_detail a LEFT JOIN wms_warehouseout b ON a.F_WarehouseOutId=b.F_Id
 WHERE b.F_WarehouseType='SaleOut' GROUP BY F_PartNo ORDER BY TotalQty DESC
 
响应数据格式(只展示至多三条数据，多的不显示)
 [
    {
        "PartNo": "02.01.C.Z-0321-05",
        "TotalQty": 600000
    },
    {
        "PartNo": "01.WM.PM32.D019-P",
        "TotalQty": 584932
    }
]
```

### 11、设备效率

#### 11.1设备故障率

```sql
sql语句

DECLARE @WarnNum		INT
DECLARE @TotalNum		INT
DECLARE @WarnRate		DECIMAL(18,0)
SELECT @WarnNum=COUNT(F_Id) from base_equip where F_Status='-1'  AND F_WorkshopId='1081' AND F_IsVirtual!=2 --报警
SELECT @TotalNum=COUNT(F_Id) from base_equip where  F_WorkshopId='1081' AND F_IsVirtual!=2 --总数
SET @WarnRate=@WarnNum*100.00/IIF(@TotalNum=0, 1, @TotalNum)
SELECT CONVERT(VARCHAR, @WarnRate) +'%' AS WarnRate

优化的sql语句
SELECT 
    CONVERT(VARCHAR, 
        SUM(CASE F_Status WHEN '-1' THEN 1 ELSE 0 END) * 100.00 / 
        NULLIF(COUNT(*), 0)
    ) + '%' AS WarnRate
FROM base_equip 
WHERE F_WorkshopId='1081' AND F_IsVirtual!=2

响应数据格式(只展示至多三条数据，多的不显示)

{
    "value": "0%"
}
```

#### 11.2设备开机率

```sql
sql语句

DECLARE @OpenNum		INT
DECLARE @TotalNum		INT
DECLARE @OpenRate		DECIMAL(18,0)
SELECT @OpenNum=COUNT(F_Id) from base_equip where (F_Status='0' OR F_Status='1') AND F_WorkshopId='1081' AND F_IsVirtual!=2 --待机+运行
SELECT @TotalNum=COUNT(F_Id) from base_equip where  F_WorkshopId='1081' AND F_IsVirtual!=2 --总数
SET @OpenRate=@OpenNum*100.00/IIF(@TotalNum=0, 1, @TotalNum)
SELECT CONVERT(VARCHAR, @OpenRate) +'%' AS OpenRate

优化后的sql语句
SELECT 
    CONVERT(VARCHAR, 
        SUM(CASE WHEN F_Status IN ('0', '1') THEN 1 ELSE 0 END) * 100.00 / 
        NULLIF(COUNT(*), 0)
    ) + '%' AS OpenRate
FROM base_equip 
WHERE F_WorkshopId='1081' AND F_IsVirtual!=2

响应数据格式(只展示至多三条数据，多的不显示)

{
    "value": "85%"
}
```

# 质量看板模块

### 1、品质分析（日）

```sql
sql语句

WITH TotalQty AS (
    SELECT 
        SUM(F_Qty) AS total_qty
    FROM 
        qc_record_result  -- 直接从 qc_record_result 表计算总数量
)
SELECT 
    b.F_Content dayss,
    SUM(c.F_Qty) AS total,
    (SUM(c.F_Qty) * 100.0 / t.total_qty) AS ratess
FROM 
    qc_record_detail a
LEFT JOIN 
    qc_record_result c ON a.F_ResultId = c.F_Id
LEFT JOIN 
    base_quailty b ON a.F_QuailtyId = b.F_Id
CROSS JOIN 
    TotalQty t
GROUP BY 
    b.F_Content, t.total_qty
ORDER BY 
    dayss DESC;
    
    响应数据格式(只展示至多三条数据，多的不显示)
    
[
    {
        "dayss": "装配",
        "total": 958,
        "ratess": 0.004013
    },
    {
        "dayss": "一致性",
        "total": 473,
        "ratess": 0.001981
    },
    {
        "dayss": "外观",
        "total": 6858,
        "ratess": 0.028733
    },
    {
        "dayss": "测试不良项",
        "total": 128,
        "ratess": 0.000536
    }
]
```

### 2、工序合格率

```sql
sql语句
select F_NodeName,sum(F_OkQty)*100.0/IIF(ISNULL(sum(F_OkQty+F_NgQty),0)=0,1,sum(F_OkQty+F_NgQty)) rate
from mes_report_detail
where F_NodeName is not null
group by F_NodeName
响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "F_NodeName": "手工组装-旋转拖把大杆",
        "rate": 99.819331
    },
    {
        "F_NodeName": "刮刮乐面板",
        "rate": 100
    },
    {
        "F_NodeName": "马桶刷下手柄壳",
        "rate": 100
    }
]
```

### 3、月生产效率分析

#### 3.1 检验总数

```sql
sql语句

select  sum(F_RequireAmount) total
--case when sum(F_RealAmount)>0 then  sum(F_OkQty)*100 /sum(F_RealAmount) else 100 end  as okRate,
--case when sum(F_RequireAmount)>0 then  sum(F_RealAmount)*100 /sum(F_RequireAmount) else 100 end planRate
  from base_workorder a
where  datediff(month, F_CreatorTime,getdate()) = 0

响应数据格式(只展示至多三条数据，多的不显示)

{
    "value": "47452956"
}


```

#### 3.2 合格率

```sql
sql语句

select 
case when sum(F_RealAmount)>0 then  sum(F_OkQty)*100 /sum(F_RealAmount) else 100 end  as okRate
--case when sum(F_RequireAmount)>0 then  sum(F_RealAmount)*100 /sum(F_RequireAmount) else 100 end planRate
  from base_workorder a
where  datediff(month, F_CreatorTime,getdate()) = 0


//注意WHERE是限制当天数据，所以当天数据可能为空。如需查看数据格式请去掉后执行语句
响应数据格式(只展示至多三条数据，多的不显示)
{
    "data": "100.00"
}
```

#### 3.3 达成率

```sql
sql语句

select 
case when sum(F_RequireAmount)>0 then  sum(F_RealAmount)*100 /sum(F_RequireAmount) else 100 end planRate
  from base_workorder a
where  datediff(month, F_CreatorTime,getdate()) = 0

响应数据格式(只展示至多三条数据，多的不显示)
{
    "data": "100.00"
}

```

### 4、日合格率趋势分析

```sql

sql语句

select top 7 convert(nvarchar(10),a.F_CreatorTime,120) a1,sum(F_Ok)*100.0/IIF(ISNULL(sum(F_Qty),0)=0,1,sum(F_qty)) rate from qc_record a
group by convert(nvarchar(10),a.F_CreatorTime,120)
order by convert(nvarchar(10),a.F_CreatorTime,120)

响应数据格式(只展示至多三条数据，多的不显示)

[
    {
        "a1": "2023-04-10",
        "rate": 99.923669
    },
    {
        "a1": "2023-04-11",
        "rate": 98.529946
    },
    {
        "a1": "2023-04-17",
        "rate": 90
    }
]
```

### 5、检验效率分析

#### 5.1 检验总完成率

```sql
sql语句
select sum(case when F_Status=2 then 1 else 0 end)*100.0/IIF(ISNULL(count(1),0)=0,1,count(1))  value
from qc_record

响应数据格式(只展示至多三条数据，多的不显示)
{
    "data": "93.85"
}
```

#### 5.2 来料检验完成率

```sql
sql语句

select ISNULL(sum(case when F_Status=2 then 1 else 0 end)*100.0/IIF(ISNULL(count(1),0)=0,1,count(1)),0)  value
from qc_record where 
F_BillType='IQC'

响应数据格式(只展示至多三条数据，多的不显示)
{
    "data": "0.00"
}
```

#### 5.3 生产检验完成率

```sql
sql语句

select ISNULL(sum(case when F_Status=2 then 1 else 0 end)*100.0/IIF(ISNULL(count(1),0)=0,1,count(1)),0)  value
from qc_record where 
F_BillType='FQC'

响应数据格式(只展示至多三条数据，多的不显示)
{
    "data": "91.05"
}
```

#### 5.4 首检验完成率

```sql
sql语句

select ISNULL(sum(case when F_Status=2 then 1 else 0 end)*100.0/IIF(ISNULL(count(1),0)=0,1,count(1)),0)  value
from qc_record where 
F_BillType='IpqcFirst'

响应数据格式(只展示至多三条数据，多的不显示)
{
    "data": "100.00"
}
```

#### 5.5 巡检完成率

```sql
sql语句

select ISNULL(sum(case when F_Status=2 then 1 else 0 end)*100.0/IIF(ISNULL(count(1),0)=0,1,count(1)),0)  value
from qc_record where 
F_BillType='IpqcInspection'

响应数据格式(只展示至多三条数据，多的不显示)
{
    "data": "92.71"
}
```

### 6、检验单状态

```sql
sql语句

SELECT count(*) as value,'待检验' name from qc_record where   F_Status=0
	union all
SELECT count(*) as value,'检验中' name  from qc_record where   F_Status=1
union all
SELECT count(*) as value,'已完成' name  from qc_record where  F_Status=2

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "value": 383,
        "name": "待检验"
    },
    {
        "value": 0,
        "name": "检验中"
    },
    {
        "value": 5842,
        "name": "已完成"
    }
]
```

### 7、检验进度

```sql
sql语句
select top 50
F_WoNo 工单号
,F_PartNo 物料编号
,F_PartName 物料名称
,F_PartSpecs 规格
,F_Qty 检验数量
,F_ok 合格数
,F_Ng 不良数
from qc_record where F_Status<2
order by F_BillDate 

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "工单号": "WO20250930034",
        "物料编号": "02.03.B.PM32.1101-10",
        "物料名称": "四面挤水拖把-面板销子-小米白7043",
        "规格": "4.5*0.5",
        "检验数量": 11120,
        "合格数": 11000,
        "不良数": 120
    },
    {
        "工单号": "WO20250930034",
        "物料编号": "02.03.B.PM32.1101-10",
        "物料名称": "四面挤水拖把-面板销子-小米白7043",
        "规格": "4.5*0.5",
        "检验数量": 20,
        "合格数": 0,
        "不良数": 0
    },
    {
        "工单号": "WO20250930034",
        "物料编号": "02.03.B.PM32.1101-10",
        "物料名称": "四面挤水拖把-面板销子-小米白7043",
        "规格": "4.5*0.5",
        "检验数量": 30,
        "合格数": 0,
        "不良数": 0
    }
]

```

### 8、来料不良分析

```sql
sql语句
WITH TotalQty AS (
    SELECT 
        SUM(F_Qty) AS total_qty
    FROM 
        qc_record_result  -- 直接从 qc_record_result 表计算总数量
)
SELECT 
    b.F_Content name,
    SUM(c.F_Qty) AS value
FROM 
    qc_record_detail a
LEFT JOIN 
    qc_record_result c ON a.F_ResultId = c.F_Id
	left join qc_record cc on c.F_BillId=c.F_Id
LEFT JOIN 
    base_quailty b ON a.F_QuailtyId = b.F_Id
CROSS JOIN 
    TotalQty t
--where cc.F_BillType='IQC'
GROUP BY 
    b.F_Content, t.total_qty
ORDER BY 
    name DESC;

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "name": "装配",
        "value": 958
    },
    {
        "name": "一致性",
        "value": 473
    },
    {
        "name": "外观",
        "value": 6858
    },
    {
        "name": "测试不良项",
        "value": 128
    }
]
```

### 9、车间合格率分析

```sql
sql语句

select aa.name,convert( decimal(18,2), round(sum(value),2)) value from (
select case when  a.F_id='1081' then '注塑'
when a.F_id='1082' then '杆盘'
else '包装' end name
,ISNULL(sum(b.F_OkQty)*100.0/IIF(ISNULL(sum(b.F_OkQty+b.F_ngqty),0)=0,1,sum(b.F_OkQty+b.F_ngqty)),0) value
 from base_organize a 
 left join base_workorder c on a.F_id=c.F_WorkShopId
left join mes_report_detail b on b.F_WoId=c.F_Id
where F_EnCode in ('H.001','H.002','H.003')
group by a.F_Id
)aa group by aa.name

响应数据格式(只展示至多三条数据，多的不显示)
{
    "xList": [
        99.71,
        100,
        99.99
    ],
    "yList": [
        "包装",
        "杆盘",
        "注塑"
    ]
}

```

### 10、返工信息统计

```sql
sql语句

select  right(convert(nvarchar(10),a.F_CreatorTime,120),5) dayss,sum(a.F_Qty) oknumb 
,convert(decimal(18,2),round(sum(a.F_Qty)*100.0/IIF(ISNULL(sum(b.F_Qty),0)=0,1,sum(b.F_Qty)),2)) ratess from qc_record_result  a
left join qc_record b on a.F_BillId=b.F_Id
where a.F_Decision=4 --返工
group by convert(nvarchar(10),a.F_CreatorTime,120)
order by convert(nvarchar(10),a.F_CreatorTime,120)

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "dayss": "12-09",
        "oknumb": 1,
        "ratess": 1
    },
    {
        "dayss": "12-23",
        "oknumb": 20,
        "ratess": 5
    }
]
```

# 仓库看板模块

### 1、仓库任务监控

#### 1.1计划入库量

```sql
sql语句
SELECT CAST(SUM(F_PlanQty) AS DECIMAL(18,0)) AS InPlanQty FROM wms_warehousein_detail 

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": 1472140708
}
```



#### 1.2 实际入库量

```sql
sql语句
SELECT CAST(SUM(F_RealQty) AS DECIMAL(18,0)) AS InRealQty FROM wms_warehousein_detail 

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": 77955598
}
```



#### 1.3 计划出库量

```sql
sql语句
SELECT CAST(SUM(F_PlanQty) AS DECIMAL(18,0)) AS OutPlanQty FROM wms_warehouseout_detail 

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": 1298840672
}
```



#### 1.4 实际出库量

```sql
sql语句

SELECT CAST(SUM(F_RealQty) AS DECIMAL(18,0)) AS OutRealQty FROM wms_warehouseout_detail

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": 1680
}
```



### 2、仓库库存监控

#### 2.1 库存总量

```sql
sql语句
SELECT CAST(SUM(F_AvailableQty) AS DECIMAL(18,0)) AS TotalQty FROM wms_inventory

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": 60516513
}
```



#### 2.2 出存总量

```sql
sql语句
SELECT CAST(SUM(F_RealQty) AS DECIMAL(18,0)) AS InRealQty FROM wms_warehousein_detail

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": 77955598
}
```



#### 2.3 出存总量

```sql
sql语句
SELECT CAST(SUM(F_RealQty) AS DECIMAL(18,0)) AS OutRealQty FROM wms_warehouseout_detail

响应数据格式(只展示至多三条数据，多的不显示)
{
    "value": 1680
}

```



### 3、近日出入库对比

```sql
sql语句

CREATE TABLE #InOutWarehouseInfo
(
	OpDate			NVARCHAR(20),
	TotalInQty		DECIMAL(18,0),
	TotalOutQty		DECIMAL(18,0)
)
DECLARE @StartIdx	INT = 0
DECLARE @EndIdx		INT = 6
DECLARE @CurDate	DATETIME = GETDATE() --'2024-12-05'
WHILE @StartIdx<=@EndIdx
BEGIN
	DECLARE @SearchDate		DATETIME
	DECLARE @StrSearchDate	NVARCHAR(10)
	SET @SearchDate=DATEADD(DAY, -@StartIdx, @CurDate)
	SET @StrSearchDate=RIGHT(CONVERT(NVARCHAR(50),@SearchDate,111),5)
	DECLARE @DayTotalIn		DECIMAL(18,0)
	DECLARE @DayTotalOut	DECIMAL(18,0)
	SELECT @DayTotalIn=ISNULL(SUM(F_Qty),0) FROM wms_warehousein_scandetail WHERE DATEDIFF(DAY, F_CreatorTime, @SearchDate)=0
	SELECT @DayTotalOut=ISNULL(SUM(F_Qty),0) FROM wms_warehouseout_scandetail WHERE DATEDIFF(DAY, F_CreatorTime, @SearchDate)=0
	INSERT INTO #InOutWarehouseInfo VALUES (@StrSearchDate,@DayTotalIn,@DayTotalOut)
	SET @StartIdx=@StartIdx+1
END

SELECT * FROM #InOutWarehouseInfo
DROP TABLE #InOutWarehouseInfo

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "OpDate": "12/11",
        "TotalInQty": 0,
        "TotalOutQty": 0
    },
    {
        "OpDate": "12/10",
        "TotalInQty": 337500,
        "TotalOutQty": 0
    },
    {
        "OpDate": "12/09",
        "TotalInQty": 209609,
        "TotalOutQty": 0
    }
]
```



### 4、物料库存监控

```sql
SELECT TOP 6 b.F_PartNo AS PartNo,b.F_PartName AS PartName,c.F_Name AS WarehouseName, a.F_AvailableQty AS CurQty
FROM wms_inventory a INNER JOIN base_part b ON a.F_PartId=b.F_Id LEFT JOIN base_warehouse c ON a.F_WarehouseId=c.F_Id
ORDER BY NEWID()
```



### 5、入库分析

```sql
sql语句

CREATE TABLE #InWarehouseInfo
(
	OpDate			NVARCHAR(20),
	FinishInQty		DECIMAL(18,0),
	RawInQty		DECIMAL(18,0)
)
DECLARE @StartIdx	INT = 0
DECLARE @EndIdx		INT = 6
DECLARE @CurDate	DATETIME = GETDATE()
WHILE @StartIdx<=@EndIdx
BEGIN
	DECLARE @SearchDate		DATETIME
	DECLARE @StrSearchDate	NVARCHAR(10)
	SET @SearchDate=DATEADD(DAY, -@StartIdx, @CurDate)
	SET @StrSearchDate=RIGHT(CONVERT(NVARCHAR(50),@SearchDate,111),5)
	DECLARE @DayFinishIn	DECIMAL(18,0)
	DECLARE @RawInIn		DECIMAL(18,0)
	SELECT @DayFinishIn=ISNULL(SUM(F_Qty),0) FROM wms_warehousein_scandetail WHERE DATEDIFF(DAY, F_CreatorTime, @SearchDate)=0 AND F_WarehouseId='992'
	SELECT @RawInIn=ISNULL(SUM(F_Qty),0) FROM wms_warehousein_scandetail WHERE DATEDIFF(DAY, F_CreatorTime, @SearchDate)=0 AND F_WarehouseId='17257'
	INSERT INTO #InWarehouseInfo VALUES (@StrSearchDate,@DayFinishIn,@RawInIn)
	SET @StartIdx=@StartIdx+1
END

SELECT * FROM #InWarehouseInfo
DROP TABLE #InWarehouseInfo

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "OpDate": "12/11",
        "FinishInQty": 0,
        "RawInQty": 0
    },
    {
        "OpDate": "12/10",
        "FinishInQty": 335741,
        "RawInQty": 1759
    },
    {
        "OpDate": "12/09",
        "FinishInQty": 188721,
        "RawInQty": 0
    }
]
```



### 6、出库分析

```sql
sql语句

CREATE TABLE #OutWarehouseInfo
(
	OpDate			NVARCHAR(20),
	FinishOutQty	DECIMAL(18,0),
	RawOutQty		DECIMAL(18,0)
)
DECLARE @StartIdx	INT = 0
DECLARE @EndIdx		INT = 6
DECLARE @CurDate	DATETIME = GETDATE()
WHILE @StartIdx<=@EndIdx
BEGIN
	DECLARE @SearchDate		DATETIME
	DECLARE @StrSearchDate	NVARCHAR(10)
	SET @SearchDate=DATEADD(DAY, -@StartIdx, @CurDate)
	SET @StrSearchDate=RIGHT(CONVERT(NVARCHAR(50),@SearchDate,111),5)
	DECLARE @DayFinishOut	DECIMAL(18,0)
	DECLARE @DayRawIn		DECIMAL(18,0)
	SELECT @DayFinishOut=ISNULL(SUM(F_Qty),0) FROM wms_warehouseout_scandetail WHERE DATEDIFF(DAY, F_CreatorTime, @SearchDate)=0 AND F_WarehouseId='992'
	SELECT @DayRawIn=ISNULL(SUM(F_Qty),0) FROM wms_warehouseout_scandetail WHERE DATEDIFF(DAY, F_CreatorTime, @SearchDate)=0 AND F_WarehouseId='17257'
	INSERT INTO #OutWarehouseInfo VALUES (@StrSearchDate,@DayFinishOut,@DayRawIn)
	SET @StartIdx=@StartIdx+1
END

SELECT * FROM #OutWarehouseInfo
DROP TABLE #OutWarehouseInfo

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "OpDate": "12/11",
        "FinishOutQty": 0,
        "RawOutQty": 0
    },
    {
        "OpDate": "12/10",
        "FinishOutQty": 0,
        "RawOutQty": 0
    },
    {
        "OpDate": "12/09",
        "FinishOutQty": 0,
        "RawOutQty": 0
    }
]

```



### 7、上架任务分析

```sql
sql语句

SELECT * FROM #InWarehouseInfo
DROP TABLE #InWarehouseInfo

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "OpDate": "12/11",
        "FinishInQty": 2,
        "RawInQty": 8
    },
    {
        "OpDate": "12/10",
        "FinishInQty": 5,
        "RawInQty": 54
    },
    {
        "OpDate": "12/09",
        "FinishInQty": 41,
        "RawInQty": 7
    }
]
```



### 8、今日出入库单据状态占比

```sql
sql语句

SELECT count(*) as value,'待出库' name from wms_warehouseout where   DATEDIFF(day, F_WarehouseDate, GETDATE()) =0 and F_Status=1
	union all
SELECT count(*) as value,'待入库' name  from wms_warehousein where   DATEDIFF(day, F_WarehouseDate, GETDATE()) =0 and F_Status=1
union all
SELECT count(*) as value,'已出库' name  from wms_warehouseout where   DATEDIFF(day, F_WarehouseDate, GETDATE()) =0 and F_Status=4
	union all
SELECT count(*) as value,'已入库' name  from wms_warehousein where   DATEDIFF(day, F_WarehouseDate, GETDATE()) =0 and F_Status=4

响应数据格式(只展示至多三条数据，多的不显示)
[
    {
        "value": 10,
        "name": "待出库"
    },
    {
        "value": 14,
        "name": "待入库"
    },
    {
        "value": 0,
        "name": "已出库"
    },
    {
        "value": 0,
        "name": "已入库"
    }
]
```



### 9、成品库实时监控

```sql
sql语句

SELECT TOP 1 b.F_PartNo AS PartNo,a.F_AvailableQty AS CurQty,c.F_Name AS LocationName
FROM wms_inventory a LEFT JOIN base_part b ON a.F_PartId=b.F_Id
LEFT JOIN base_location c ON a.F_LocationId=c.F_Id
 WHERE a.F_WarehouseId='992' ORDER BY NEWID()
 
  响应数据格式(只展示至多三条数据，多的不显示)
 [
    {
        "PartNo": "30.46.H1.YPD07-25L070-101",
        "CurQty": 1939,
        "LocationName": "外协件仓库_待分类"
    }
]
```



### 10、包装车间实时监控

```sql
sql语句

SELECT TOP 1 a.F_PartNo AS PartNo,CAST(ISNULL(SUM(a.F_PlanQty),0) AS DECIMAL(18,0)) AS TotalQty,'默认货位' AS LocationName
FROM wms_warehousein_detail a LEFT JOIN wms_warehousein b ON a.F_WarehouseInId=b.F_Id
 WHERE b.F_WorkShopId='1083' GROUP BY a.F_PartNo ORDER BY NEWID()
 
 响应数据格式(只展示至多三条数据，多的不显示)
 
 [
    {
        "PartNo": "20.01.A.2001-01",
        "TotalQty": 221,
        "LocationName": "默认货位"
    }
]
```



### 11、杆盘车间实时监控

```sql
sql语句

SELECT TOP 1 a.F_PartNo AS PartNo,CAST(ISNULL(SUM(a.F_PlanQty),0) AS DECIMAL(18,0)) AS TotalQty,'默认货位' AS LocationName
FROM wms_warehousein_detail a LEFT JOIN wms_warehousein b ON a.F_WarehouseInId=b.F_Id
 WHERE b.F_WorkShopId='1082' GROUP BY a.F_PartNo ORDER BY NEWID()
 
  响应数据格式(只展示至多三条数据，多的不显示)
  
 [
    {
        "PartNo": "20.03.A.2404-05",
        "TotalQty": 77740,
        "LocationName": "默认货位"
    }
]
```



### 12、原料库实时监控

```sql
sql语句
SELECT TOP 1 b.F_PartNo AS PartNo,a.F_AvailableQty AS CurQty,c.F_Name AS LocationName
FROM wms_inventory a LEFT JOIN base_part b ON a.F_PartId=b.F_Id
LEFT JOIN base_location c ON a.F_LocationId=c.F_Id
 WHERE a.F_WarehouseId='992' ORDER BY NEWID()
 
 响应数据格式(只展示至多三条数据，多的不显示)
 
 [
    {
        "PartNo": "30.46.W1.M18-25G00603",
        "CurQty": 2680,
        "LocationName": "外协件仓库_待分类"
    }
]
```

